// Rarity colors for the card's border
$rarity-common: #888;
$rarity-uncommon: #6e7c5a;
$rarity-rare: #60708f;
$rarity-unique: #c8a658;

$stat-hp: #c53d3d;
$stat-armor: #3e4b86;
$stat-initiative: #c5b05c;

.cardPositionContainer {
  height: 100%;
  border-radius: 8px;
  border: 2px dashed #3a3a3a;
  position: relative;

  .move-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
    &:hover {
      .move-indicator span {
        color: #eee;
      }
    }
  }

  .move-indicator {
    position: absolute;
    width: 100%;
    text-align: center;
    pointer-events: none;

    &.move-backward {
      bottom: 0;
      margin-bottom: 1rem;
    }
    &.move-forward {
      top: 0;
      margin-top: 1rem;
    }

    span {
      font-size: 0.9rem;
      font-weight: bold;
      color: #888;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      transition: color 0.2s ease-in-out;
    }
  }
}

.combatCard {
  position: relative;
  left: 0;
  width: 180px;
  height: 260px;
  border-radius: 8px;
  background-color: #2a2a2a;
  box-sizing: border-box;
  flex-shrink: 0;
  transition:
    transform 0.2s ease-in-out,
    box-shadow 0.2s ease-in-out,
    top 0.2s ease-in-out;

  overflow: hidden;
  z-index: 2;

  border: 3px solid;

  &.cardPosition0,
  &.cardPosition2 {
    top: 100%;
    transform: translateY(-100%);
    &:hover:not(.isMoving) {
      transform: translateY(calc(-100% - 5px));
    }
  }
  &.cardPosition1,
  &.cardPosition3 {
    top: 0;
    &:hover:not(.isMoving) {
      transform: translateY(5px);
    }
  }

  &.common {
    border-color: $rarity-common;
  }
  &.uncommon {
    border-color: $rarity-uncommon;
  }
  &.rare {
    border-color: $rarity-rare;
  }
  &.unique {
    border-color: $rarity-unique;
  }

  .stats-display {
    position: absolute;
    top: 8px;
    right: 8px;
    z-index: 3; // Поверх .image-container
    display: flex;
    flex-direction: column;
    gap: 5px;
    pointer-events: none; // Не мешает ховеру на карточке
  }

  .stat-bubble {
    width: 28px;
    height: 28px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 2px solid rgba(0, 0, 0, 0.4);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);

    span {
      color: white;
      font-size: 0.9rem;
      font-weight: bold;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
    }

    &.hp {
      background-color: $stat-hp;
    }
    &.armor {
      background-color: $stat-armor;
    }
    &.initiative {
      background-color: $stat-initiative;
    }
  }

  .image-container {
    width: 100%;
    height: 100%;

    img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: center top;
    }
  }

  .weapon-display {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background-color: rgba(0, 0, 0, 0.75); // Semi-transparent background
    padding: 0.5rem;
    border-top: 1px solid rgba(255, 255, 255, 0.1); // Subtle top border

    // Align icon and text horizontally
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;

    .weapon-icon {
      width: 24px;
      height: 24px;
      object-fit: contain;
      // Flips the weapon icon to face the center of the card
      transform: scaleX(-1);
    }

    .weapon-name {
      font-size: 0.9rem;
      font-weight: bold;
      color: #fff;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
      text-transform: capitalize; // e.g., "makeshiftKnife" -> "Makeshiftknife"
    }
  }
}
